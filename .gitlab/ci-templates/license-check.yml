# ~~ Generated by projen. To modify, edit .projenrc.js and run "pnpm dlx projen && pnpm nx run-many --target=build".

stages:
  - build
license header:
  stage: build
  image:
    name: public.ecr.aws/amazonlinux/amazonlinux:2
  rules:
    - if: $CI_MERGE_REQUEST_IID
    - if: $CI_COMMIT_BRANCH == $CI_DEFAULT_BRANCH
  variables:
    LICENSE_FILE: /tmp/license-check/license-header.txt
  before_script:
    - yum install -y tar gzip git
    - mkdir -p /tmp/license-check && curl -s https://raw.githubusercontent.com/lluissm/license-header-checker/master/install.sh | bash -s -- -b /tmp/license-check
    - sed -n 1,12p .projenrc.js > $LICENSE_FILE && cat $LICENSE_FILE
  script:
    - /tmp/license-check/license-header-checker -a -r -i node_modules,cdk.out,coverage $LICENSE_FILE . ts tsx js java && ([[ -z `git status -s` ]] || (echo "Found files violdate with license header" && exit 1))
